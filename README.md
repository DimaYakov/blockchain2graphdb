Имеющееся программное обеспечение реализует: 

•	механизм сканирования блокчейна Bitcoin, хранящегося в специализированном виде, которое предоставляет стандартное программное обеспечение Bitcoin Core; 

•	механизм хранения содержащейся в нём информации (данные о блоках, транзакциях и адресах) в виде графовой базы данных; 

•	механизм автоматического пополнения этой базы данных актуальными версиями блокчейна, а также механизм отката в случае, если последние сохранённая в базу данных информация перестаёт быть актуальной. 

Данное программное обеспечение было реализовано полностью на языке Java. В качестве инструмента для сборки проекта был использован фреймворк 
Apache Maven, в качестве графовой базы данных – JanusGraph, использующий Apache Cassandra в качестве хранилища данных и Elasticsearch в качестве поискового механизма. Также для корректного декодирования файлов, в которых Bitcoin Core хранит всю актуальную информацию о блокчейне, была использована библиотека Bitcoinj, предназначенная для работы с протоколом Bitcoin. 
 Программное обеспечение разрабатывалось и тестировалось под операционную систему Ubuntu (в частности, версия 18.04 LTS), хотя с некоторыми изменениями может быть интегрировано и в Windows. Поэтому руководство пользователя описано для использования в операционной системе Ubuntu. 
 
РУКОВОДСТВО ПОЛЬЗОВАТЕЛЯ 
 
Первым делом необходимо скачать и установить последнюю версию Bitcoin Core . Это можно сделать как по ссылке, так и с помощью консольной команды  

$ sudo snap install bitcoin-core 

 Для более поздних версий Ubuntu (до версии 16.04), чтобы воспользоваться этой командой, предварительно нужно установить Snap с помощью команд 
 
$ sudo apt update 

$ sudo apt install snapd 

После чего необходимо запустить установившееся приложение, которое при первом запуске предложит выбрать директорию для хранения актуальной версии блокчейна (на данный момент - это около 300Gb данных), инициализировать синхронизацию блоков и дождаться окончания синхронизации (этот процесс может занять от двенадцати часов до нескольких дней в зависимости от загруженности сети). Эта директория ещё понадобится, поэтому её следует запомнить. 

Следующим шагом будет установка и запуск сервера JanusGraph. Для этого нужно скачать архив “janusgraph-full-0.5.2.zip” со страницы релизов , распаковать его, перейти в создавшуюся директорию “janusgraph-full-0.5.2” и из этой директории запустить сервер с помощью консольной команды  

…/janusgraph-full-0.5.2$ bin/janusgraph.sh start 

Для последующих действий необходимо скачать и установить git и maven с помощью команд 

$ sudo apt update 

$ sudo apt install maven 

$ sudo apt install git 
 
Далее необходимо выгрузить исходники разработанного программного обеспечения из репозитория на github командой

$ git clone https://github.com/DimaYakov/blockchain2graphdb.git 

Чтобы собрать проект, нужно перейти в скачавшуюся директорию “blockchain2graphdb” и воспользоваться из неё консольной командой  

…/blckchain2graphdb$ mvn package 

Далее необходимо изменить файл “blockchain2graph.conf”, либо создать свой, но с таким же названием. Файл должен включать в себя только три строки: 

	строка, начинающаяся с “datadir=”, в которой после знака равно без пробелов и прочих знаков указывается путь, который был указан при запуске Bitcoin Core и по которому загружалась актуальная версия блокчейна (это путь к папке, в которой содержится папка “blocks”, в которой хранятся интересующие нас данные), в стандартном варианте (если название папки не было изменено вручную) этот путь заканчивается папкой “/.bitcoin”; 

	строка, начинающаяся с “configdir=”, в которой после знака равно без пробелов и прочих знаков указывается путь к папке, в которой лежит файл “blk-cql.properties”, который хранится в папке “conf” скачанных 
исходников, то есть этот путь должен заканчиваться папкой “/conf” (также можно создать файл с таким же именем в любом месте и указать путь к папке с ним, главное, чтобы содержимое было как представлено ниже); 
 
gremlin.graph=org.janusgraph.core.JanusGraphFactory 

storage.backend=cql storage.cql.keyspace=blk 

storage.hostname=127.0.0.1 index.blk.backend=elasticsearch 

index.blk.index-name=blk 

index.blk.hostname=127.0.0.1 
 
 строка, начинающаяся с “bitcoindir=”, в которой после знака равно без пробелов и прочих знаков указывается путь к папке, в которой лежит файл “bitcoind”, который появился после установки Bitcoin Core. По стандарту это будет следующий путь “/snap/bitcoin-core/63/bin”.  
Пример содержимого файла “blockchain2graph.conf”
 
datadir=/home/chuits/snap/bitcoin-core/common/.bitcoin

configdir=/home/chuits/IdeaProjects/Blockchain2Graph/conf 

bitcoindir=/snap/bitcoin-core/63/bin 

 
 Если не выполнить условия, перечисленные выше, и, например, создать конфигурационный файл, в котором не будет одного из аргументов, или неправильно указать пути, или указать несуществующие пути и т.д., то запущенная программа (процесс запуска рассмотрен ниже) выдаст соответствующее сообщение и завершит работу. Например: 

	“There's no bitcoindir= argument in blockchain2graph.conf or null argument”, здесь не указан аргумент “bitcoindir=” или нет строки с таким параметром;  “There's no path /A/B/C from blockchain2graph.conf configdir= argument”, здесь указан несуществующий пусть как аргумент параметра “configdir=”; 

	“There's no blocks directory in path /home/src from blockchain2graph.conf datadir= argument”, здесь неверно указан путь к файлам блокчейна (путь к папке, в которой лежит папка “blocks”). 

После выполнения сборки проекта в папке targets появится файл “blockchain2graph-1.0-jar-with-dependencies.jar”, и теперь можно выполнять запуск программы. Запуск лучше выполнять из директории, в которой находится уже упомянутый файл “blockchain2graph.conf”, так как тогда можно будет не указывать к нему путь при запуске программы. Запуск программы из консоли выглядит следующим образом  

$ java -Xms128m -Xmx8g -jar filename1 filename2 

Первые два флага означают, что JVM может использовать от 128Мб до 8Гб памяти, это нужно, так как программа работает с огромным количеством данных.  

Вместо filename1 нужно указать путь к “blockchain2graph-1.0-jar-withdependencies.jar” файлу. Если запуск выполняется из папки с исходниками (папка 	“blockchain2graphdb”), 	то 	этот 	путь 	указывается 	просто 

“target/blockchain2graph-1.0-jar-with-dependencies.jar”. 
	
  Вместо 	filename2 	нужно 	указать 	путь 	к 	папке 	с 	файлом 

“blockchain2graph.conf”. Если выполнять команду из папки, где этот файл и находится, то можно не указывать аргумент filename2. 

Примеры команды: 

…/blockchain2graphdb$ java -Xms128m -Xmx8g -jar target/blockchain2graph-1.0-jar-with-dependencies.jar 
 
…/SomeDirctory$ java -Xms128m -Xmx8g -jar /home/projects/blockchain2graphdb/target/blockchain2graph-1.0-jarwith-dependencies.jar /home/projects/blockchain2graphdb 

После этого программа начнёт сканировать скачанные с помощью Bitcoin Core файлы, добавляя соответствующую информацию из блоков в базу данных. Как только отсканируется весь имеющийся блокчейн, программа перейдёт в режим автоматического пополнения, и когда будет появляться информация о новых блоках, которых не было в базе данных, или об устаревших, которые уже есть, то будут выполняться процедуры пополнения и отката соответственно.  

Если завершить процесс выполнения программы, то при следующем запуске она корректно продолжит выполнение с последнего имеющегося в базе данных блока (например, на этапе сканирования). 

Если пользователь решит завершить работу программы без намерения повторного запуска в ближайшее время, то лучше отключить JanusGraph сервер. Для этого из директории “janusgraph-full-0.5.2”, в которую был распакован 
архив, необходимо выполнить консольную команду 

…/ janusgraph-full-0.5.2$ bin/janusgraph.sh stop 

И когда в следующий раз пользователь решит продолжить выполнение программы, сначала нужно будет запустить из той же директории JanusGraph сервер с помощью команды 

…/ janusgraph-full-0.5.2$ bin/janusgraph.sh start 

А затем запустить программу, как это было описано выше с помощью команды 

$ java -Xms128m -Xmx8g -jar filename1 filename2 
